FROM mcr.microsoft.com/dotnet/core/sdk:3.1.302-alpine3.12
WORKDIR /dotnet-example

build:
    COPY src src
    RUN dotnet publish src/HelloEarthly -o publish && find /tmp -type s | xargs rm
    SAVE ARTIFACT publish AS LOCAL publish

docker:
    COPY +build/publish .
    ENTRYPOINT ["dotnet", "HelloEarthly.dll"]
    SAVE IMAGE dotnet-example:latest
